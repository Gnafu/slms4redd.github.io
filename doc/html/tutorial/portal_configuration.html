<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Portal: Initial Configuratiion &mdash; UNREDD NFMS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/redd.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="UNREDD NFMS 1.0 documentation" href="../index.html" />
    <link rel="up" title="DRC NFMS Portal training" href="index.html" />
    <link rel="next" title="GeoBatch administration" href="geobatch_admin.html" />
    <link rel="prev" title="Web services" href="webservices.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/un-redd.gif" alt="Logo"/>
    </a>
  </div>
  <div class="faologo">
  <table><tr><td>
    <a href="http://www.fao.org/">
      <img class="logo" src="../_static/fao_logo.gif" alt="FAO"/>
    </a>
	</td><td>

      <img class="logo" src="../_static/undp_logo.gif" alt="undp"/>
    </td><td>
      <img class="logo" src="../_static/unep.gif" alt="unep"/>

	</td>
	</td></tr></table>
  </div>

</div>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="geobatch_admin.html" title="GeoBatch administration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="webservices.html" title="Web services"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UNREDD NFMS 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">DRC NFMS Portal training</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="portal-initial-configuratiion">
<h1>Portal: Initial Configuratiion<a class="headerlink" href="#portal-initial-configuratiion" title="Permalink to this headline">¶</a></h1>
<p>The NFMS portal is the platform puclic application of the platform, and it&#8217;s utilized to publish the NFMS geographical and statistical data.</p>
<p>Noth the layout and the data shown of the portal van be customized depending on the needs of the countty. The application comes with a basic default configuration that can be used as a starting point.</p>
<p>In our case, we start for the following initial page:</p>
<img alt="../_images/portal_initial_config.png" src="../_images/portal_initial_config.png" />
<p>The portal is accessible from:</p>
<blockquote>
<div><a class="reference external" href="http://localhost/portal/">http://localhost/portal/</a></div></blockquote>
<div class="section" id="configuration-directory">
<h2>Configuration directory<a class="headerlink" href="#configuration-directory" title="Permalink to this headline">¶</a></h2>
<p>The configuration directory  (<code class="file docutils literal"><span class="pre">/var/portal</span></code>) has the following structure:</p>
<div class="highlight-python"><div class="highlight"><pre>/var/portal
  |- portal.properties
  |- layers.json
  |- header.tpl
  |- footer.tpl
  |- messages/...
  \- static/
      |- unredd.css
      |- custom.js
      |- img/...
      \- loc/
          |- en/
          │   |- documents/...
          │   |- html/...
          │   \- images...
          \- es
              |- documents/...
              |- html/...
              \- images/...
</pre></div>
</div>
<p>The main files are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">portal.properties</span></code>, contains the connection parameters and defines the supported languages.</li>
<li><code class="docutils literal"><span class="pre">layers.json</span></code>, the most important file, contains the configuration of the layers and the data to be shown on the portal.</li>
<li><code class="docutils literal"><span class="pre">headers.tpl</span></code> and <code class="docutils literal"><span class="pre">footer.tpl</span></code>, header and footer section of the main page.</li>
<li><code class="docutils literal"><span class="pre">messages/</span></code> contains the text translated in different languages</li>
<li><code class="docutils literal"><span class="pre">static/</span></code> contains all the other files: css stylesheets, custom javascript code, and other static files like documents and images</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="configuration-of-the-layout">
<h2>Configuration of the layout<a class="headerlink" href="#configuration-of-the-layout" title="Permalink to this headline">¶</a></h2>
<div class="section" id="header-and-footer">
<h3>Header and footer<a class="headerlink" href="#header-and-footer" title="Permalink to this headline">¶</a></h3>
<p>The header elements are contained in header.tml, in HTML format. You can add content
inside a <em>div</em> and <em>a</em> elements within the element <code class="docutils literal"><span class="pre">&lt;div</span> <span class="pre">id=&quot;banner&quot;&gt;</span></code>, for example:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;flag&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;logos&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>The two logos come from the web pages of the related organizations. The id attribute will be utilized by the stylesheet <code class="docutils literal"><span class="pre">unredd.css</span></code>
where an image and other visualization paramters are associated with it. As an exercise:</p>
<blockquote>
<div><ul class="simple">
<li>Open the file <code class="docutils literal"><span class="pre">custom.css</span></code> and find the elements &#8220;flag&#8221; and &#8220;logos&#8221;.</li>
<li>Change the images <code class="docutils literal"><span class="pre">flag.png</span></code> and <code class="docutils literal"><span class="pre">logos.png</span></code> with the DRC ones (you can find them in <code class="docutils literal"><span class="pre">Training</span> <span class="pre">data/img/</span></code> directory</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://www.csstutorial.net/">CSS tutorial</a></p>
</div>
<p>The template for the footer <code class="docutils literal"><span class="pre">footer.tpl</span></code> works the same way. In this case, we can add useful links to the portal under the element <code class="docutils literal"><span class="pre">&lt;div</span> <span class="pre">id=&quot;footer_links&quot;&gt;</span></code>:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&quot;satisfaction_survey_link&quot;</span> <span class="na">href=</span><span class="s">&quot;${survey_url}&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>${satisfaction_survey}<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&quot;user-group&quot;</span> <span class="na">href=</span><span class="s">&quot;http://groups.google.com/group/nfms4redd-users&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>${nfms_mailing_list}<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>Here we can see some ${...} elements, like <code class="docutils literal"><span class="pre">${survey_url}</span></code>, <code class="docutils literal"><span class="pre">${satisfaction_survey}</span></code> and <code class="docutils literal"><span class="pre">${nfms_mailing_list}</span></code>.
These template elements will be substituted with translated text messages.</p>
<p>As an exercise:</p>
<blockquote>
<div><ul class="simple">
<li>Search the elements <cite>survey_url</cite>, <cite>satisfaction_survey</cite> and <cite>nfms_mailing_list</cite> in <code class="docutils literal"><span class="pre">messages_fr.properties</span></code>.</li>
</ul>
</div></blockquote>
<p>To apply the changes, you will need to restart the application:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo service diss_geoserver restart
</pre></div>
</div>
</div>
</div>
<div class="section" id="multilanguage-support">
<h2>Multilanguage support<a class="headerlink" href="#multilanguage-support" title="Permalink to this headline">¶</a></h2>
<p>The file <cite>messages.properties`</cite> in the <code class="docutils literal"><span class="pre">messages</span></code> director contains the default translated messages. It&#8217;s the text that will be used in case it has not be translated to a specific language. The files containing the text for a specific language have a suffix with the language code, following the standard &lt;<a class="reference external" href="http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes</a>&gt;`_.</p>
<p>To add a language (for example spanish):</p>
<blockquote>
<div><ul>
<li><p class="first">Edit <code class="docutils literal"><span class="pre">portal.properties</span></code> and add the element <code class="docutils literal"><span class="pre">&quot;es&quot;:</span> <span class="pre">&quot;Español&quot;</span></code> to the <code class="docutils literal"><span class="pre">languages</span></code> property:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">languages</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;es&quot;</span><span class="p">:</span> <span class="s">&quot;Español&quot;</span><span class="p">,</span> <span class="s">&quot;fr&quot;</span><span class="p">:</span> <span class="s">&quot;Françoise&quot;</span><span class="p">,</span> <span class="s">&quot;en&quot;</span><span class="p">:</span> <span class="s">&quot;English&quot;</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Copy the file messages_fr.properties and give it the new name <code class="docutils literal"><span class="pre">messages_es.properties</span></code></p>
</li>
<li><p class="first">Translate the text in <code class="docutils literal"><span class="pre">messages_es.properties</span></code>.</p>
</li>
<li><p class="first">Restart the application to apply the changes with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo service diss_geoserver restart
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="configuration-of-a-new-layer">
<h2>Configuration of a new layer<a class="headerlink" href="#configuration-of-a-new-layer" title="Permalink to this headline">¶</a></h2>
<p>The definition of the layers to be shown on the portal is in the file <code class="docutils literal"><span class="pre">layers.json</span></code>.</p>
<p><code class="docutils literal"><span class="pre">layers.json</span></code> contains the information that associates the user interface elements (layer list panel on the left of the page) with the WMS layers
published on GeoServer, personalizes the legend, and defines which layers can be queryed. It also groups layers into categories.</p>
<p>The format utilized to store this information is JSON:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>JSON resources</p>
<ul class="last simple">
<li><a class="reference external" href="http://www.json.org/">Introduction to the JSON format</a></li>
<li><a class="reference external" href="http://jsonformatter.curiousconcept.com/">JSON validator</a></li>
</ul>
</div>
<p>The file <code class="docutils literal"><span class="pre">layers.json</span></code> contains three sections:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">layers</span></code></li>
<li><code class="docutils literal"><span class="pre">contexts</span></code></li>
<li><code class="docutils literal"><span class="pre">contextGroups</span></code></li>
</ul>
<p>In these section we&#8217;ll perform two exercises:</p>
<ul class="simple">
<li>First, we&#8217;ll add the administrative units layer to the existing group &#8220;admin_areas&#8221;.</li>
<li>Then we&#8217;ll add the UCL layer in a new layer group.</li>
</ul>
<div class="section" id="layers">
<h3>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h3>
<p>Before going through this exercise you will have to add a new vector layer to <code class="docutils literal"><span class="pre">http://localhost/diss_geoserver</span></code> using the data <code class="docutils literal"><span class="pre">Training</span> <span class="pre">data/GIS/administrative_areas/provinces.*</span></code> and assign it the style <code class="docutils literal"><span class="pre">Training</span> <span class="pre">data/GIS/provinces.sld</span></code>.</p>
<p>Each &#8220;layer&#8221; object in the JSON file relates to a layer published on GeoServer, and describes the connection to the server to get the map.</p>
<div class="highlight-js"><div class="highlight"><pre><span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span>
   <span class="p">...</span>
   <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
    <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://localhost/diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:provinces&quot;</span><span class="p">,</span>
    <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<ul class="simple">
<li>It is possible to copy and paste one of the existing elements:<ul>
<li>the new must be distinct from the other ones, for example &#8220;provinces&#8221;</li>
<li>the new wmsName will be &#8220;unredd:provinces&#8221;</li>
<li>the baseUrl must point to the GeoServer server from were we will get the layer</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="contexts">
<h3>Contexts<a class="headerlink" href="#contexts" title="Permalink to this headline">¶</a></h3>
<p>Each context groups one or more layers and complements the information adding the data needed to show it in the graphical interface (active/not active, link to a file with information about the layer(s), URL for the inline legend, ...).</p>
<div class="highlight-js"><div class="highlight"><pre><span class="s2">&quot;contexts&quot;</span><span class="o">:</span> <span class="p">[</span>
  <span class="p">...</span>
  <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
    <span class="s2">&quot;active&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${provinces}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;infoFile&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces_def.html&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;provinces&quot;</span><span class="p">],</span>
    <span class="s2">&quot;inlineLegendUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://localhost/diss_geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=20&amp;HEIGHT=20&amp;LAYER=provinces&amp;TRANSPARENT=true&amp;RULE=border&quot;</span>
  <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<ul class="simple">
<li>Add a new &#8220;context&#8221; object, with the same structure and values as &#8220;country&#8221;, but with the following differences:<ul>
<li>the new &#8220;id&#8221; will be &#8220;provinces&#8221;</li>
<li>the new label will be ${provinces}. Again, the syntax ${...} will be substituted in a localised text.</li>
<li>in &#8220;infoFile&#8221; we will put &#8220;provinces_def.html&#8221;. This will create a link to a document with the layer information (<code class="file docutils literal"><span class="pre">static/loc/&lt;lang&gt;/html</span></code>).</li>
<li>in &#8220;layers&#8221; we will put [&#8220;provinces&#8221;], which references the layer we just created</li>
<li>In &#8220;inlineLegendUrl&#8221; we will put the parameter <cite>LAYER=unredd:provinces</cite> to generate an image with the legend</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="contextgroups">
<h3>ContextGroups<a class="headerlink" href="#contextgroups" title="Permalink to this headline">¶</a></h3>
<p>&#8220;contextGroups&#8221; is a recursive structure used to group context in the layer panel on the portal web page. A &#8220;group&#8221; element can contain another group or an array of contexts defined in the &#8220;contexts&#8221; object.</p>
<div class="highlight-js"><div class="highlight"><pre><span class="s2">&quot;contextGroups&quot;</span><span class="o">:</span>
<span class="p">{</span>
  <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${admin_areas}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;country&quot;</span> <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Add a new element <cite>{ &#8220;context&#8221;: &#8220;provinces&#8221; }</cite> after the <cite>{ &#8220;context&#8221;: &#8220;country&#8221; }</cite> element. This will include the new layer context to the provinces context group</li>
<li>Finally, utilize the JSON validator to check the syntax of the new <code class="file docutils literal"><span class="pre">layers.json</span></code>, and reload the page</li>
</ul>
<p>At the end of the process, the content of the file should be the following:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span><span class="p">,</span>
      <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://demo1.geo-solutions.it/diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
      <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:drc_boundary&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png8&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;sourceLink&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.wri.org/publication/interactive-forest-atlas-democratic-republic-of-congo&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sourceLabel&quot;</span><span class="o">:</span> <span class="s2">&quot;WRI&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
      <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>

  <span class="s2">&quot;contexts&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span><span class="p">,</span>
      <span class="s2">&quot;active&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${country_boundaries}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;countryBoundaries&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;active&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${provinces}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;infoFile&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces_def.html&quot;</span><span class="p">,</span>
      <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;provinces&quot;</span><span class="p">],</span>
      <span class="s2">&quot;inlineLegendUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://localhost/diss_geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=20&amp;HEIGHT=20&amp;LAYER=provinces&amp;TRANSPARENT=true&amp;RULE=border&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;contextGroups&quot;</span><span class="o">:</span>
  <span class="p">{</span>
    <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${admin_areas}&quot;</span><span class="p">,</span>
          <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span> <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Forest area and forest area change&quot;</span><span class="p">,</span>
          <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="initial-extent-of-the-map-and-server-prefix">
<h2>Initial extent of the map and server prefix<a class="headerlink" href="#initial-extent-of-the-map-and-server-prefix" title="Permalink to this headline">¶</a></h2>
<p>The file <code class="docutils literal"><span class="pre">static/custom.js</span></code> contains the initial map extent and zoom level, and an array of default WMS servers.</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">UNREDD</span><span class="p">.</span><span class="nx">restrictedExtent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mi">20037508</span><span class="p">,</span> <span class="o">-</span><span class="mi">20037508</span><span class="p">,</span> <span class="mi">20037508</span><span class="p">,</span> <span class="mi">20037508</span><span class="p">);</span>
<span class="nx">UNREDD</span><span class="p">.</span><span class="nx">maxResolution</span> <span class="o">=</span> <span class="mf">4891.969809375</span><span class="p">;</span>
<span class="nx">UNREDD</span><span class="p">.</span><span class="nx">mapCenter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">LonLat</span><span class="p">(</span><span class="mi">2500000</span><span class="p">,</span> <span class="o">-</span><span class="mi">400000</span><span class="p">);</span>
<span class="nx">UNREDD</span><span class="p">.</span><span class="nx">defaultZoomLevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="nx">UNREDD</span><span class="p">.</span><span class="nx">wmsServers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">//&quot;http://demo1.geo-solutions.it&quot;,</span>
    <span class="c1">//&quot;http://incuweb84-33-51-16.serverclienti.com&quot;</span>
<span class="p">];</span>
</pre></div>
</div>
<p><em>UNREDD.mapCenter</em> contains the coordinate of the center in Google Mercator proection (EPSG:900913 or EPSG:3857), the coordinate reference system of the web application.</p>
<p>To increase/decrease the initial zoom level you can increase/decrease the value of <em>UNREDD.defaultZoomLevel</em>.</p>
<p>Finally we can observe that some of the <em>baseUrl</em> values in the previous chapter don&#8217;t contain a server. These URLs are completed by the software by adding one of the server specified in <em>UNREDD.wmsServers</em>.</p>
</div>
<div class="section" id="exercise-configure-a-new-layer-group">
<h2>Exercise: Configure a new layer group<a class="headerlink" href="#exercise-configure-a-new-layer-group" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s repeat the previous exercise to add a forest classification layer.</p>
<ul class="simple">
<li>Before going through this exercise you will have to add a new vector layer to <code class="docutils literal"><span class="pre">http://localhost/diss_geoserver</span></code> using the data <code class="docutils literal"><span class="pre">Training</span> <span class="pre">data/GIS/forest_classification.tif</span></code> and assign it the style <code class="docutils literal"><span class="pre">Training</span> <span class="pre">data/GIS/provinces.sld</span></code>.</li>
<li>For the new layer we will use the id &#8220;forest_classification&#8221; and the wms layer name &#8220;unredd:forest_classification&#8221;. Then we will add a new <cite>&#8220;legend&#8221;: &#8220;forest_classification.png&#8221;</cite> to show the layer legend. This attribute reference a localized image in <code class="file docutils literal"><span class="pre">static/loc/&lt;lang&gt;/images/</span></code>.</li>
<li>The new &#8220;context&#8221; will contain only three elements: <cite>&#8220;id&#8221;: &#8220;forest_classification&#8221;</cite>, <cite>&#8220;label&#8221;: &#8220;${ucl_forest_classification}</cite>, and <cite>&#8220;layers&#8221;: [&#8220;forest_classification&#8221;]</cite>.</li>
<li>We will add the new context in the context group with <cite>&#8220;label&#8221;: &#8220;Forest area and forest area change&#8221;</cite>.</li>
<li>After validating the JSON and reloading the page, we will have the new layer in the portal page.</li>
</ul>
<p>At the end of the exercise the content of <cite>layers.json</cite> will be:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Order matters: the layers defined first are shown on the top of the following ones.</p>
</div>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;forest_classification&quot;</span><span class="p">,</span>
      <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;/diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
      <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:forest_classification&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;legend&quot;</span><span class="o">:</span> <span class="s2">&quot;forest_classification.png&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span><span class="p">,</span>
      <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://demo1.geo-solutions.it/diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
      <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:drc_boundary&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png8&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;sourceLink&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.wri.org/publication/interactive-forest-atlas-democratic-republic-of-congo&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sourceLabel&quot;</span><span class="o">:</span> <span class="s2">&quot;WRI&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;baseUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;/diss_geoserver/gwc/service/wms&quot;</span><span class="p">,</span>
      <span class="s2">&quot;wmsName&quot;</span><span class="o">:</span> <span class="s2">&quot;unredd:provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;imageFormat&quot;</span><span class="o">:</span> <span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>

  <span class="s2">&quot;contexts&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span><span class="p">,</span>
      <span class="s2">&quot;active&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${country_boundaries}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;countryBoundaries&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span><span class="p">,</span>
      <span class="s2">&quot;active&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${provinces}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;infoFile&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces_def.html&quot;</span><span class="p">,</span>
      <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;provinces&quot;</span><span class="p">],</span>
      <span class="s2">&quot;inlineLegendUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://localhost/diss_geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=20&amp;HEIGHT=20&amp;LAYER=provinces&amp;TRANSPARENT=true&amp;RULE=border&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;forest_classification&quot;</span><span class="p">,</span>
      <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${ucl_forest_classification}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;layers&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;forest_classification&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>

  <span class="s2">&quot;contextGroups&quot;</span><span class="o">:</span>
  <span class="p">{</span>
    <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;${admin_areas}&quot;</span><span class="p">,</span>
          <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;countryBoundaries&quot;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;provinces&quot;</span> <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;group&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;Forest area and forest area change&quot;</span><span class="p">,</span>
          <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;context&quot;</span><span class="o">:</span> <span class="s2">&quot;forest_classification&quot;</span> <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Portal: Initial Configuratiion</a><ul>
<li><a class="reference internal" href="#configuration-directory">Configuration directory</a></li>
<li><a class="reference internal" href="#configuration-of-the-layout">Configuration of the layout</a><ul>
<li><a class="reference internal" href="#header-and-footer">Header and footer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multilanguage-support">Multilanguage support</a></li>
<li><a class="reference internal" href="#configuration-of-a-new-layer">Configuration of a new layer</a><ul>
<li><a class="reference internal" href="#layers">Layers</a></li>
<li><a class="reference internal" href="#contexts">Contexts</a></li>
<li><a class="reference internal" href="#contextgroups">ContextGroups</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initial-extent-of-the-map-and-server-prefix">Initial extent of the map and server prefix</a></li>
<li><a class="reference internal" href="#exercise-configure-a-new-layer-group">Exercise: Configure a new layer group</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="webservices.html"
                        title="previous chapter">Web services</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="geobatch_admin.html"
                        title="next chapter">GeoBatch administration</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="geobatch_admin.html" title="GeoBatch administration"
             >next</a> |</li>
        <li class="right" >
          <a href="webservices.html" title="Web services"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UNREDD NFMS 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >DRC NFMS Portal training</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, FAO Forestry &amp; GeoSolutions SAS.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>